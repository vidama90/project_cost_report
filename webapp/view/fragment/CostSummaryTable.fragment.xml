<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns="sap.m"
    xmlns:l="sap.ui.layout"
>
    <VBox width="100%"
    visible="{ViewControl>/Tables/ShowCostSummary}"
    >
        <Toolbar>
            <ToolbarSpacer />
            <Button
                icon="sap-icon://full-screen"
                press=".onCostSummaryTableFullScreen"
                tooltip="Open in Fullscreen"
            />
            <Button
                icon="sap-icon://personnel-view"
                press=".onCostDetailTablePersonalizePress"
                tooltip="Personalize Table"
            />
        </Toolbar>
        <table:Table
            id="CostSummaryTable"
            visible="{ViewControl>/Tables/ShowCostSummary}"
            selectionMode="None"
            enableColumnFreeze="true"
            fixedColumnCount="3"
            fixedBottomRowCount="1"
            rowsUpdated=".onTableRowsUpdated"
            class="mainTable"
            rows="{
                path: 'to_CostDetail',
                parameters: {
                    groupId: 'costChanges'
                },
                sorter: {
                    path: 'counter',
                    descending: false
                }
            }"
        >
            <table:rowSettingsTemplate>
                <table:RowSettings
                    highlight="{= 
                        ${HierarchyLevel}===2 ? 'Information' : 
                        ${HierarchyLevel}===3 ? 'Warning' : 
                        ${HierarchyLevel}===4 ? 'Success' : 
                        'None'
                    }"
                />
            </table:rowSettingsTemplate>

            <table:columns>
                <table:Column id="CostSummaryTableColumnWBSLevel2Descr">
                    <table:label>
                        <Label
                            text="{i18n>colWBSLevel2}"
                            textAlign="Left"
                        />
                    </table:label>
                    <table:template>
                        <HBox>
                            <Text
                                text="{WBSLevel2Descr}"
                                class="emphasizedColumn"
                                visible="{= ${HierarchyLevel} !== 5 &amp;&amp; ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                                <Text
                                    text="Sub Total:-"
                                    textAlign="Right"
                                    class="hierarchyLevel6"
                                    visible="{= ${HierarchyLevel} === -1}"
                                />
                                <Text
                                    text="Total:-"
                                    textAlign="Right"
                                    class="hierarchyLevel7"
                                    visible="{= ${HierarchyLevel} === -2}"
                                />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnWBSLevel3Descr">
                    <table:label>
                        <Label
                            text="{i18n>colWBSLevel3}"
                            textAlign="Left"
                        />
                    </table:label>
                    <table:template>
                        <HBox>
                            <Text
                                text="{WBSLevel3Descr}"
                                class="emphasizedColumn"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text
                                text="{WBSLevel3Descr}"
                                class="emphasizedColumn hierarchyLevel6"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text
                                text="{WBSLevel3Descr}"
                                class="emphasizedColumn hierarchyLevel7"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnWBSLevel4Descr">
                    <table:label>
                        <Label
                            text="{i18n>colWBSLevel4}"
                            textAlign="Left"
                        />
                    </table:label>
                    <table:template>
                        <HBox>
                            <Text
                                text="{WBSLevel4Descr}"
                                class="emphasizedColumn"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text
                                text="{WBSLevel4Descr}"
                                class="emphasizedColumn hierarchyLevel6"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text
                                text="{WBSLevel4Descr}"
                                class="emphasizedColumn hierarchyLevel7"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnTenderCost" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colTenderCost}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['TenderCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['TenderCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['TenderCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnRevisedBudget" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colRevisedBudget}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['RevisedBudget', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['RevisedBudget', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['RevisedBudget', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnPotentialFinalAccountCost" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colPotentialFinalCost}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['PotentialFinalAccountCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${ViewControl>/Mode/IsEditable} === false &amp;&amp; ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['PotentialFinalAccountCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['PotentialFinalAccountCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                            <Input
                                value="{ parts: ['PotentialFinalAccountCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: false}}"
                                visible="{= ${ViewControl>/Mode/IsEditable} === true &amp;&amp; ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                                width="auto"
                                class="amount-field"
                                textAlign="End"
                                change=".onCurrencyInputChange"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnActualCostPO" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colActualCostPO}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['ActualCostPO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['ActualCostPO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['ActualCostPO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnActualCostSO" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colActualCostSO}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['ActualCostSO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['ActualCostSO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['ActualCostSO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnCommitedCostPO" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colCommitedCostPO}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['CommitedCostPO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['CommitedCostPO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['CommitedCostPO', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnTotalPOCost" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colTotalPOCost}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['TotalPOCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['TotalPOCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['TotalPOCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnCostToComplete" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colCostToComplete}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['CostToComplete', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${ViewControl>/Mode/IsEditable} === false &amp;&amp; ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['CostToComplete', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['CostToComplete', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                            <Input
                                value="{ parts: ['CostToComplete', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: false}}"
                                visible="{= ${ViewControl>/Mode/IsEditable} === true &amp;&amp; ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                                width="auto"
                                class="amount-field"
                                textAlign="End"
                                change=".onCurrencyInputChange"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnProjectedFinalCost" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colProjectedFinalCost}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['ProjectedFinalCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['ProjectedFinalCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['ProjectedFinalCost', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnVariance" width="10rem">
                    <table:label>
                        <Label
                            text="{i18n>colVariance}"
                            textAlign="Right"
                        />
                    </table:label>
                    <table:template>
                        <HBox justifyContent="End">
                            <Text 
                                text="{ parts: ['Variance', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}"
                            />
                            <Text 
                                text="{ parts: ['Variance', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel6 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -1}"
                            />
                            <Text 
                                text="{ parts: ['Variance', 'TransactionCurrency'], type: 'sap.ui.model.type.Currency'}" 
                                class="hierarchyLevel7 amount-field"
                                textAlign="End"
                                visible="{= ${HierarchyLevel} === -2}"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
                <table:Column id="CostSummaryTableColumnRemarks" width="8rem">
                    <table:label>
                        <Label
                            text="{i18n>colRemarks}"
                            textAlign="Left"
                        />
                    </table:label>
                    <table:template>
                        <HBox visible="{= ${HierarchyLevel} !== -1 &amp;&amp; ${HierarchyLevel} !== -2}">
                            <Text 
                                text="{Remarks}" 
                                visible="{= ${ViewControl>/Mode/IsEditable} === false}"
                            />
                            <Input
                                value="{Remarks}"
                                visible="{= ${ViewControl>/Mode/IsEditable} === true}"
                                width="auto"
                                maxLength="255"
                            />
                        </HBox>
                    </table:template>
                </table:Column>
            </table:columns>
        </table:Table>
    </VBox>
</core:FragmentDefinition>
